

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Diag &mdash; ThemisPy 0+untagged.68.g3aa0939 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="ThemisPy 0+untagged.68.g3aa0939 documentation" href="../../index.html"/>
        <link rel="up" title="User’s Guide" href="userguide.html"/>
        <link rel="next" title="Developer’s Guide" href="devel.html"/>
        <link rel="prev" title="Chain" href="chain.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> ThemisPy
          

          
          </a>

          
            
            
              <div class="version">
                0+untagged.68.g3aa0939
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="userguide.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="userguide.html#structure-and-philosphy">Structure and philosphy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="userguide.html#packages">Packages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="chain.html">Chain</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Diag</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="devel.html">Developer’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ThemisPy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="userguide.html">User’s Guide</a> &raquo;</li>
        
      <li>Diag</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/docs/src/diag.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="module-diag"></span><div class="section" id="diag">
<span id="id1"></span><h1>Diag<a class="headerlink" href="#diag" title="Permalink to this headline">¶</a></h1>
<span class="target" id="module-diag.convergence_tools"></span><dl class="function">
<dt id="diag.convergence_tools.auto_window">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">auto_window</code><span class="sig-paren">(</span><em class="sig-param">taus</em>, <em class="sig-param">c</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#auto_window"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.auto_window" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatic windowing procedure following <a class="reference external" href="https://emcee.readthedocs.io/en/stable/tutorials/autocorr">emcee</a>, which follows <a class="reference external" href="https://pdfs.semanticscholar.org/0bfe/9e3db30605fe2d4d26e1a288a5e2997e7225.pdf">Sokal (1989)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>taus</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Estimates of the integrated autocorrelation time (IACT).</p></li>
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Sokal factor, with an optimal value approximately of 5.0.  Default: 5.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Index of minimum window for computing the autocorrelation time?</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.autocorr_func_1d">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">autocorr_func_1d</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">norm=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#autocorr_func_1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.autocorr_func_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the 1D autocorrelation function of a sequences, following
<a class="reference external" href="https://emcee.readthedocs.io/en/stable/tutorials/autocorr">emcee</a>.
This is done via FFT, and thus assumes that the sequences is stationary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – A sequence of values.</p></li>
<li><p><strong>norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If true normalizes the autocorrelation by the variance. Otherwise the zero-lag component of the autocorrelation function is the variance. Default: True.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Autocorrlation function appropriately normalized.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(numpy.ndarra)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.bulk_split_rhat">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">bulk_split_rhat</code><span class="sig-paren">(</span><em class="sig-param">chains</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#bulk_split_rhat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.bulk_split_rhat" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the bulk <span class="math notranslate nohighlight">\(\hat{R}\)</span> using rank normalized chains. The returned value is the
maximum of the folded <span class="math notranslate nohighlight">\(\hat{R}\)</span> and regular rank normalized <span class="math notranslate nohighlight">\(\hat{R}\)</span> as recommended in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019arXiv190308008V/abstract">Vehtari (2019)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – A single walker chain arranged as a 3D array indexed by [runs, samples, parameters].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of values of the split <span class="math notranslate nohighlight">\(\hat{R}\)</span> statistic from <a class="reference external" href="http://www.stat.columbia.edu/~gelman/book/">Gelman (2013)</a> for each parameter in the chain using rank-normalized values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.ensemble_autocorr">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">ensemble_autocorr</code><span class="sig-paren">(</span><em class="sig-param">param_chain</em>, <em class="sig-param">c=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#ensemble_autocorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.ensemble_autocorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the integrated autocorrelation time for the chain, following <a class="reference external" href="https://emcee.readthedocs.io/en/stable/tutorials/autocorr">emcee</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_chain</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Ensemble MCMC chain for a single parameters, arranged as walkers,steps.</p></li>
<li><p><strong>c</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Sokal factor, with an optimal value approximately of 5.0.  Default: 5.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Integrated autocorrelation time (IACT).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.find_eautocorr">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">find_eautocorr</code><span class="sig-paren">(</span><em class="sig-param">echain</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#find_eautocorr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.find_eautocorr" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds and returns the integrated autocorrelation time (IACT) for each parameter
in the ensemble chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>echain</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Ensemble MCMC chain, generated, e.g., from <a class="reference internal" href="chain.html#chain.mcmc_chain.read_echain" title="chain.mcmc_chain.read_echain"><code class="xref py py-func docutils literal notranslate"><span class="pre">chain.mcmc_chain.read_echain()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of autocorrelation times for each parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.fold_chains">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">fold_chains</code><span class="sig-paren">(</span><em class="sig-param">chains</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#fold_chains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.fold_chains" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the chain folded around the median of all the chains, i.e., for each
parameter <span class="math notranslate nohighlight">\(p\)</span>, every chain sample is replaced with <span class="math notranslate nohighlight">\(|p-\bar{p}|\)</span>
where <span class="math notranslate nohighlight">\(\bar{p}\)</span> is the median across all chains.
This helps with measuring <span class="math notranslate nohighlight">\(\hat{R}\)</span> in the tails.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – A single walker chain arranged as a 3D array indexed by [runs, samples, parameters].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Folded single walker chain arranged as 3D array index by [runs, samples, parameters].</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.mean_echain">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">mean_echain</code><span class="sig-paren">(</span><em class="sig-param">echain</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#mean_echain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.mean_echain" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the average of the ensemble chain for each step. That is,
we average over the walkers at each step converting the chain into a
single particle chain of the average.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>echain</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Ensemble MCMC chain, generated, e.g., from <a class="reference internal" href="chain.html#chain.mcmc_chain.read_echain" title="chain.mcmc_chain.read_echain"><code class="xref py py-func docutils literal notranslate"><span class="pre">chain.mcmc_chain.read_echain()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Chain data arranged as 2D array indexed by [sample, parameter] <em>after</em> averaging over walkers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.mean_ess">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">mean_ess</code><span class="sig-paren">(</span><em class="sig-param">y</em>, <em class="sig-param">c=5.0</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#mean_ess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.mean_ess" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the average ESS across chains by dividing the number of steps by the IAC.
Note the actual ESS of the entire chain and walkers is greater than this, but likely isn’t
the number of walkers * mean_ess since the chains are correlated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Ensemble MCMC chain for a single parameters, arranged as walkers,steps.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Average number of ensemble samples across chains.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.next_pow_two">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">next_pow_two</code><span class="sig-paren">(</span><em class="sig-param">n</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#next_pow_two"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.next_pow_two" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the value of 2**n, following <a class="reference external" href="https://emcee.readthedocs.io/en/stable/tutorials/autocorr">emcee</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Power of 2</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Value of 2**n</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)">int</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.ranknormalized_chains">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">ranknormalized_chains</code><span class="sig-paren">(</span><em class="sig-param">chains</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#ranknormalized_chains"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.ranknormalized_chains" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the rank-normalized chains, where the rank is taken over all the chains.
This allows <span class="math notranslate nohighlight">\(\hat{R}\)</span> to be used when we the distribution might not have a finite
mean or variance.</p>
<p>Returns the rank normalized chains, i.e. the z-scores and the actual ranks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of chains, stored as 2D arrays indexed by [sample,parameter].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of probability densities associated with given rank; Array of ranks for each parameter value.  Both are provided in the <em>same</em> order as the original data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>, <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.save_ensemble_diagnostics">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">save_ensemble_diagnostics</code><span class="sig-paren">(</span><em class="sig-param">out_file_name</em>, <em class="sig-param">chains</em>, <em class="sig-param">chainsname</em>, <em class="sig-param">method='rank'</em>, <em class="sig-param">stride=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#save_ensemble_diagnostics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.save_ensemble_diagnostics" title="Permalink to this definition">¶</a></dt>
<dd><p>Outputs the diagnostics of the multiple chains in <cite>chains</cite> to the out file,
where the chain is kept track of in <cite>chainsname</cite>. Currently it only outputs
the chains integrated autocorrelation time for each parameter. Eventually
other diagnostics will be included, such as the
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1992StaSc...7..457G/abstract">Gelman-Rubin</a>
diagnostic, i.e. split-<span class="math notranslate nohighlight">\(\hat{R}\)</span>, and ESS. Currently the default method for
<span class="math notranslate nohighlight">\(\hat{R}\)</span> is the rank method from
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2019arXiv190308008V/abstract">Vehtari (2019)</a>.</p>
<p>Note that if the integrated autocorrelation time (IACT) is “significantly different”
between chains, then at least one of the chains is not converged.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Name of file to which to output results.</p></li>
<li><p><strong>chains</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of chains for which to compute diagnostics.</p></li>
<li><p><strong>chainsname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – List of names (str) of chains for output.</p></li>
<li><p><strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – CURRENTLY UNUSED</p></li>
<li><p><strong>stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Factor by which the chains have been thinned by.  Default: 1.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.split_rhat">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">split_rhat</code><span class="sig-paren">(</span><em class="sig-param">chains</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#split_rhat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.split_rhat" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the split <span class="math notranslate nohighlight">\(\hat{R}\)</span> statistic from
<a class="reference external" href="http://www.stat.columbia.edu/~gelman/book/">Gelman (2013)</a>. This is able to
deal with distributions that don’t have finite mean and/or variance. Additionally,
it splits the chain in two in order to check if the beginning and end of the chain
have similar variance to check for intrachain convergence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chains</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – A single walker chain arranged as a 3D array indexed by [runs, samples, parameters].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>An array of values of the split <span class="math notranslate nohighlight">\(\hat{R}\)</span> statistic from <a class="reference external" href="http://www.stat.columbia.edu/~gelman/book/">Gelman (2013)</a> for each parameter in the chain.</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="diag.convergence_tools.var_echain">
<code class="sig-prename descclassname">diag.convergence_tools.</code><code class="sig-name descname">var_echain</code><span class="sig-paren">(</span><em class="sig-param">echain</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/diag/convergence_tools.html#var_echain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#diag.convergence_tools.var_echain" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the variance of the echain for each step. That is, we compute the
variance of the walkers at each step, converting the chain into a single
particle chain of the variance between chains.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>echain</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Ensemble chain data, generated, e.g., from <a class="reference internal" href="chain.html#chain.mcmc_chain.read_echain" title="chain.mcmc_chain.read_echain"><code class="xref py py-func docutils literal notranslate"><span class="pre">chain.mcmc_chain.read_echain()</span></code></a>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Variance of chain data arranged as 2D array indexed by [sample, parameter] <em>after</em> computing the variance over walkers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)">numpy.ndarray</a>)</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="devel.html" class="btn btn-neutral float-right" title="Developer’s Guide" accesskey="n">Next →</a>
      
      
        <a href="chain.html" class="btn btn-neutral" title="Chain" accesskey="p">← Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Themis Development Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0+untagged.68.g3aa0939',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE: 'true'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>